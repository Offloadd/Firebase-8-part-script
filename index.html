<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Offload - Modular V2</title>
   
   <!-- Firebase SDK -->
   <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
   <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
   <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
   
   <script>
       // Firebase configuration
       const firebaseConfig = {
           apiKey: "AIzaSyA89BZxelKRoK64JnYtSdWUho2WUfWymII",
           authDomain: "capacity-monitor.firebaseapp.com",
           projectId: "capacity-monitor",
           storageBucket: "capacity-monitor.firebasestorage.app",
           messagingSenderId: "455641716280",
           appId: "1:455641716280:web:5848888e290e47114c78cd",
           measurementId: "G-CGR5R0D1SP"
       };

       // Initialize Firebase
       firebase.initializeApp(firebaseConfig);
       const auth = firebase.auth();
       const db = firebase.firestore();
       
       // Make db available globally
       window.db = db;

       // Auth state listener
       auth.onAuthStateChanged(user => {
           if (user) {
               document.getElementById('authContainer').style.display = 'none';
               document.getElementById('app').style.display = 'block';
               document.getElementById('logoutBtn').style.display = 'block';
               document.getElementById('userBadge').style.display = 'block';
               document.getElementById('userEmail').textContent = user.email;
               window.currentUser = user;
               loadState();
               loadCustomSlidersFromFirestore().then(() => {
                   loadFromFirestore().then(() => render());
               });
           } else {
               document.getElementById('authContainer').style.display = 'block';
               document.getElementById('app').style.display = 'none';
               document.getElementById('logoutBtn').style.display = 'none';
               document.getElementById('userBadge').style.display = 'none';
               window.currentUser = null;
           }
       });
   </script>
   
   <link rel="stylesheet" href="styles.css">
</head>
<body>
   <div class="user-badge" id="userBadge">
       ðŸ‘¤ <span id="userEmail"></span>
   </div>
   <button id="logoutBtn" onclick="handleLogout()">Logout</button>
   
   <div id="authContainer" class="auth-container">
       <div class="auth-title">Offload</div>
       <div class="subtitle" style="text-align: center; margin-bottom: 20px;">Sign in to save your data to the cloud</div>
       <div id="authMessage" class="auth-message"></div>
       <input type="email" id="emailInput" class="auth-input" placeholder="Email" autocomplete="email">
       <input type="password" id="passwordInput" class="auth-input" placeholder="Password (min 6 characters)" autocomplete="current-password">
       <button class="auth-btn" id="signInBtn" onclick="handleSignIn()">Sign In</button>
       <button class="auth-btn" id="createAccountBtn" onclick="handleCreateAccount()">Create Account</button>
   </div>

   <div id="introModal" class="modal-overlay" onclick="if(event.target === this) closeIntroModal()">
       <div class="modal-content">
           <button class="modal-close" onclick="closeIntroModal()">Ã—</button>
           <h2 style="margin-bottom: 16px; color: #111827;">Welcome to Offload</h2>
           <div id="introModal_content" contenteditable="true" style="color: #374151; line-height: 1.6; margin-bottom: 16px; padding: 12px; border: 2px dashed #d1d5db; border-radius: 8px; outline: none;">
               <p style="margin-bottom: 12px;">This self help tool is heavily based on a concept called the Window of Tolerance. Which says that our nervous systems basically have limits as to how much internal information can be safely processed in a given amount of time. There's all kinds of information out there about chronic stress and trauma and how to take care of yourself and all that. But no one ever encouraged me to be kinder towards myself, to slow down and pace myself. It was quite the opposite in fact. I remember and there still is a lot of peer pressure to work harder and longer and never give up. Like we are all encouraging ourselves to break ourselves down over and over and become self sabotaging by pushing ourselves too hard for too long in life.</p>
               <p style="margin-bottom: 12px;">Anyways, to make a long story short, this self help tool was built to help me overcome those patterns of overworking myself and the beliefs that high performance was the only way to become a successful adult. This tool helps me tune into the quieter parts of my intuition that know how to keep me from overworking myself and to stop believing in self sabotaging inner narratives. It helps me recognize what it feels like when I am tempted to let my decisions get hijacked by old emotional logic and be able to disobey those old corrosive masters. This tool helps me to understand how much internal and external things are affecting my nervous system at any given time.</p>
               <p style="margin-bottom: 12px;">Offload helps you track your emotional tolerance and nervous system state in real-time.</p>
               <p style="margin-bottom: 12px;">Using this Offload self help tool can take a little bit of getting used. There is a learning curve to it but if a user can be a bit open minded and think about if their ratings are agreeing with them or not, that is the key to unlocking new perspectives and self realizations. Trying to perfect ratings is not recommended because that can be a distraction from getting good enough information out from the shadow and into the light. Yes, this can be used as a shadow work tool if that is helpful for you to think of it that way.</p>
               <p style="margin-bottom: 0;">Start wherever feels right - there's no wrong way to begin.</p>
           </div>
           <div style="text-align: center; margin-top: 16px;">
               <button onclick="saveAllModalContent(['introModal']);" style="padding: 10px 20px; background: #16a34a; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">ðŸ’¾ Save Changes</button>
           </div>
       </div>
   </div>

   <div id="infoModal1" class="modal-overlay" onclick="if(event.target === this) closeInfoModal('infoModal1')">
       <div class="modal-content">
           <button class="modal-close" onclick="closeInfoModal('infoModal1')">Ã—</button>
           <h2 style="margin-bottom: 16px; color: #111827;">Where to Start - Info</h2>
           <div style="color: #374151; line-height: 1.6; padding: 12px; border-radius: 8px; min-height: 100px;">
               <p style="margin-bottom: 12px;">There are 4 slider sections here for you to use. They use numbers and colors to help you externalize internal information in a way that you can easily agree with in a logical and intuitive way. The slider information affects the larger and colorful visualization, near the bottom, which shows how the rated topics are or could be affecting your nervous system.</p>
               
               <p style="margin-bottom: 12px;">Keep in mind this is all just a representation of what your internal information could look like when externalized this way. Not hard and super specific or concrete evidence to get hung up on. This whole tool is designed as something to learn about how life affects you in general so you can let go of the unhelpful sticky things more easily. It is meant to show you how stress or opportunities can reduce your ability to process information in a calm, grounded and regulated way. But also what kinds of things can bring you back to a more regulated or grounded state where you are more able to handle lifes demands and guide your own decisions more easily.</p>
               
               <p style="margin-bottom: 12px;">This tool can also be used like a gratitude journal and it is recommended to capture experiences that feel joy or happiness or when you are calm and relaxed. Capturing those experiences and keeping them in the data sets maintains a record that at some point, you were able to have a positive or calming experience and the narratives or conditions about how those happened.</p>
               
               <p style="margin-bottom: 12px;">The easiest one to begin with is section 4. the Specific Experience slider. It is the best tool to use for "in the moment" things like an intense emotion or an emotional hijacking event but also less intense experiences like ruminations and stuck thoughts or feelings. There can be layers of stuck thoughts or feelings so it might take 3 or 4 saved sliders or data sets to get unstuck from them. The data sets are stored at the very bottom and accumulate over time. Which is a feature designed to help your brain let go of unstuck thoughts or feelings because you now have a record of that event or experience and it is saved somewhere safe that you can look at it again in the future if you need to.</p>
               
               <p style="margin-bottom: 12px;"><strong>*** All the saved information is protected by your email and password login and you can choose to keep the data for reflecting on later or delete it. It's yours, you can do what you want with it.</strong></p>
               
               <p style="margin-bottom: 0;">The other slider sections are designed to help map out common life areas a bit. It helps identify common life topics and gives them their own editable scales to help create consistent themes about how they affect you or your perceptions of them. Like how work can be stressful and stabilizing, or dating can be both an opportunity and a stressor. It all depends on how they affect you. This is where section 4 can come in handy as well. It is where you can record those multiple layers about 1 specific topic or experience. "Work was stressful because... but it is also supporting or stabilizing me financially." You can create individual sliders for each of those things and save them into the data sets at the bottom.</p>
               
               <p style="margin-bottom: 0;">Good luck!</p>
           </div>
       </div>
   </div>

   <div id="infoModal2" class="modal-overlay" onclick="if(event.target === this) closeInfoModal('infoModal2')">
       <div class="modal-content">
           <button class="modal-close" onclick="closeInfoModal('infoModal2')">Ã—</button>
           <h2 style="margin-bottom: 16px; color: #111827;">Window of Tolerance - Info</h2>
           <div id="infoModal2_content" contenteditable="true" style="color: #374151; line-height: 1.6; padding: 12px; border: 2px dashed #d1d5db; border-radius: 8px; min-height: 100px; outline: none;">
               <p style="margin-bottom: 12px;">This dynamic picture will show you how your ratings are possibly affecting your nervous system. The blue area in the middle is how much regulated processing power your body and mind have compared to how much pressure exists from stressors or opportunities. Keep in mind this is not a perfect science and it's just meant to show you a way of seeing how your mind and body are reacting to what your are thinking about or what is preoccupying your attention.</p>
               <p style="margin-bottom: 0;">The legend on the left is designed to show you a bit of a path from chronic high stress states down into longer or higher quality recovery periods and into zones where you have more flexibility for a range of emotions or feelings. It is also editable so that you can start mapping out your own path with words that work for you.</p>
           </div>
           <div style="text-align: center; margin-top: 16px;">
               <button onclick="saveAllModalContent(['infoModal2']);" style="padding: 10px 20px; background: #16a34a; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">ðŸ’¾ Save Changes</button>
           </div>
       </div>
   </div>

   <div id="infoModal3" class="modal-overlay" onclick="if(event.target === this) closeInfoModal('infoModal3')">
       <div class="modal-content">
           <button class="modal-close" onclick="closeInfoModal('infoModal3')">Ã—</button>
           <h2 style="margin-bottom: 16px; color: #111827;">Current Entry - Info</h2>
           <div id="infoModal3_content" contenteditable="true" style="color: #374151; line-height: 1.6; padding: 12px; border: 2px dashed #d1d5db; border-radius: 8px; min-height: 100px; outline: none;">
               <p style="margin-bottom: 12px;">The entries areas here are where you ratings are stored. The are protected by your user name and password and you can use them how you wish. You can use this information in AI chats but I highly recommend doing so with a "guidance script."</p>
               <p style="margin-bottom: 12px;">A guidance script is basically preloading and AI bot with a set of rules to guide the AI bot's responses. I created my own guidance script for things that include Shadow Work, Inner Child Work, Complex Trauma Recovery, Attachment Theory, and some concepts from books I have read that have been very helpful at one time or another. They are basically lenses that an AI bot will view and respond to your data sets through.</p>
               <p style="margin-bottom: 0;">***This is for educational purposes only and if it is making things worse for you or you are taking the information in here as concrete facts instead of just a way to validate or percieve your experiences, please stop and don't use this thing. Otherwise, give it a couple days and see how your ratings start changing and settling.</p>
           </div>
           <div style="text-align: center; margin-top: 16px;">
               <button onclick="saveAllModalContent(['infoModal3']);" style="padding: 10px 20px; background: #16a34a; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">ðŸ’¾ Save Changes</button>
           </div>
       </div>
   </div>

   <div class="container" id="app"></div>

   <!-- Load JavaScript files in order -->
   <script src="auth.js"></script>
   <script src="firestore.js"></script>
   <script src="storage.js"></script>
   <script src="state.js"></script>
   <script src="sliders.js"></script>
   <script src="calculations.js"></script>
   <script src="entries.js"></script>
   <script src="modals.js"></script>
   <script src="render-helpers.js"></script>
   <script src="render.js"></script>
</body>
</html>
